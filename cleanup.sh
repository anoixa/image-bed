#!/bin/bash
# 清理 obvious 的中文行内注释

echo "Cleaning up obvious Chinese comments..."

# 1. 删除单独一行的简单中文注释
find . -name "*.go" -not -path "./vendor/*" -not -path "./.git/*" -exec \
    sed -i '/^\s*\/\/\s*\(创建\|获取\|检查\|删除\|更新\|提供\|尝试\|构建\|生成\|验证\|读取\|写入\|查询\|处理\|返回\|调用\|启动\|停止\|初始化\|清理\|设置\|发送\|接收\|解析\|序列化\|压缩\|解压\|加密\|解密\|加载\|保存\|打开\|关闭\|执行\|提交\|回滚\|等待\|通知\|监听\|连接\|断开\|上传\|下载\|复制\|移动\|重命名\|遍历\|过滤\|排序\|分组\|聚合\|计算\|转换\|格式化\|授权\|认证\|登录\|登出\|注册\|配置\|缓存\|存储\|图片\|文件\|目录\|路径\|大小\|宽度\|高度\|长度\|数量\|索引\|键\|值\|类型\|状态\|结果\|错误\|成功\|失败\|默认\|当前\|最新\|第一\|最后\|之前\|之后\)[^a-zA-Z]*$/d' {} \;

# 2. 删除行尾的 obvious 中文注释
find . -name "*.go" -not -path "./vendor/*" -not -path "./.git/*" -exec \
    sed -i 's/\s*\/\/\s*\(默认\|缓存\|配置\|存储\|图片\|目录\|文件\|路径\|大小\|宽度\|高度\|原图\|缩略图\|变体\|格式\|转换\|处理\|上传\|下载\|本地\|远程\|内存\|数据库\|查询\|检查\|创建\|获取\|删除\|更新\|设置\)[^a-zA-Z]*$//' {} \;

# 3. 格式化代码
gofmt -w .

echo "Cleanup complete!"
